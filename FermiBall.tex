
%% helper macros
\newcommand\pgfmathsinandcos[3]{%
  \pgfmathsetmacro#1{sin(#3)}%
  \pgfmathsetmacro#2{cos(#3)}%
}
\newcommand\LongitudePlane[3][current plane]{%
  \pgfmathsinandcos\sinEl\cosEl{#2} % elevation
  \pgfmathsinandcos\sint\cost{#3} % azimuth
  \tikzset{#1/.estyle={cm={\cost,\sint*\sinEl,0,\cosEl,(0,0)}}}
}
\newcommand\LatitudePlane[3][current plane]{%
  \pgfmathsinandcos\sinEl\cosEl{#2} % elevation
  \pgfmathsinandcos\sint\cost{#3} % latitude
  \pgfmathsetmacro\yshift{\cosEl*\sint}
  \tikzset{#1/.estyle={cm={\cost,0,0,\cost*\sinEl,(0,\yshift)}}} %
}
\newcommand\DrawLongitudeCircle[2][1]{
  \LongitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
   % angle of "visibility"
  \pgfmathsetmacro\angVis{atan(sin(#2)*cos(\angEl)/sin(\angEl))} %
  \draw[current plane] (\angVis:1) arc (\angVis:\angVis+180:1);
  \draw[current plane,dashed] (\angVis-180:1) arc (\angVis-180:\angVis:1);
}
\newcommand\DrawLatitudeCircle[2][1]{
  \LatitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\sinVis{sin(#2)/cos(#2)*sin(\angEl)/cos(\angEl)}
  % angle of "visibility"
  \pgfmathsetmacro\angVis{asin(min(1,max(\sinVis,-1)))}
  \draw[current plane] (\angVis:1) arc (\angVis:-\angVis-180:1);
  \draw[current plane,dashed] (180-\angVis:1) arc (180-\angVis:\angVis:1);
}

%% document-wide tikz options and styles

\tikzset{%
  >=latex, % option for nice arrows
  inner sep=0pt,%
  outer sep=2pt,%
  mark coordinate/.style={inner sep=0pt,outer sep=0pt,minimum size=3pt,
    fill=black,circle}%
}


\begin{tikzpicture} % MERC

%% some definitions

\def\R{3} % sphere radius
\def\angEl{25} % elevation angle
\def\angAz{-110} % azimuth angle
\def\angPhiOne{-50} % longitude of point P
\def\angPhiTwo{-0} % longitude of point Q
\def\angGamma{40} % latitude of point P and Q
\def\angBeta{30} % latitude of point P and Q

%% working planes

\pgfmathsetmacro\H{\R*cos(\angEl)} % distance to north pole
\LongitudePlane[xyplane]{\angAz}{\angEl}
\LongitudePlane[xzplane]{\angEl}{\angAz}
\LongitudePlane[pzplane]{\angEl}{\angPhiOne}
\LongitudePlane[qzplane]{\angEl}{\angPhiTwo}
\LongitudePlane[fzplane]{-290}{-25}
\LatitudePlane[equator]{\angEl}{0}

%% draw background sphere
\fill[ball color=white] (0,0) circle (\R); % 3D lighting effect
\draw (0,0) circle (\R);

%% characteristic points
\coordinate (O) at (0,0);
\path[xyplane] (\R,0) coordinate (XY);
\path[xzplane] (\R*2,0) coordinate (ZA);
\path[pzplane] (\angBeta:\R) coordinate (P);
\path[pzplane] (\R,0) coordinate (PE);
\path[qzplane] (\angBeta:\R) coordinate (Q);
\path[qzplane] (\R*1.5,0) coordinate (XA);
\path[fzplane] (\R,0) coordinate (FV);

%% meridians and latitude circles
\DrawLatitudeCircle[\R]{\angBeta}
\DrawLatitudeCircle[\R]{\angGamma}
\DrawLatitudeCircle[\R]{0} % equator


%% draw lines and put labels
\draw (O) -- (0,\R*1.5) node[above=0.1cm] {\Large{$p_y$}};
\draw (O) -- (ZA) node[below left=0.1cm] {\Large{$p_z$}};
\draw (O) -- (XA) node[right=0.1cm] {\Large{$p_x$}};
\draw[->] (O) -- (FV) node[xshift=0.4cm, yshift=-0.1cm] {\Large{$\boldsymbol{p_F}$}};

\draw (\R-0.5,\R-1) -- (\R+.8,\R-1);
\draw (\R-0.13,\R-1.5) -- (\R+.8,\R-1.5);
\draw[->,>=stealth',shorten >=1pt] (\R+.78,\R-.5) -- (\R+.78,\R-1);
\draw[->,>=stealth',shorten >=1pt] (\R+.78,\R-2) -- (\R+.78,\R-1.5) node[xshift=0.6cm, yshift=0.23cm] {\Large{d$p_y$}};

\end{tikzpicture}